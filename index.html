<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkedIn Post Generator - Newsec</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- REACT (for preview/gallery) -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <style>
      /* ... keep your tailwind+custom CSS here ... */
    </style>
</head>
<body class="bg-gray-50">

<!-- ... Your existing main markup, steps, and forms here ... -->

<!-- NEW: LinkedIn Post Preview & Stock Image Gallery Root -->
<div id="postPreviewRoot" class="max-w-xl mx-auto my-8"></div>

<!-- ... rest of your markup ... -->

<script>
/* --- Your regular app logic: generatePost, etc... --- */

window._postPreviewUpdate = () => {}; // placeholder

// Overwrite your displayPost function to also update the preview
function displayPost(post) {
    const postDiv = document.getElementById('generatedPost');
    const fullText = post.full || (post.hook + post.body + post.cta + post.hashtags);
    postDiv.innerHTML = `<div class="space-y-3 text-gray-700 whitespace-pre-line">${fullText}</div>`;
    if (window._postPreviewUpdate) window._postPreviewUpdate({ postText: fullText });
    document.getElementById('postStats').classList.remove('hidden');
}

// Also call this when image changes:
function updatePreviewImage(url) {
    if (window._postPreviewUpdate) window._postPreviewUpdate({ imageUrl: url });
}
</script>

<!-- REACT GALLERY & LINKEDIN PREVIEW (NO JSX NEEDED) -->
<script type="text/javascript">
const { useState, useEffect } = React;

// DUMMY stock images (replace with your Unsplash or brand images)
const images = [
    'https://images.unsplash.com/photo-1506765515384-028b60a970df?w=600',
    'https://images.unsplash.com/photo-1522199710521-72d69614c702?w=600',
    'https://images.unsplash.com/photo-1504384308090-c894fdcc538d?w=600',
    'https://images.unsplash.com/photo-1492684223066-81342ee5ff30?w=600',
    'https://images.unsplash.com/photo-1581094651308-cadb47c147fa?w=600',
    'https://images.unsplash.com/photo-1542744173-8e7e53415bb0?w=600'
];

// Simulate "Newsec on-brand" - update with your real profile/logo
const BRAND_PROFILE_IMG = 'https://newsec.com/favicon.ico';
const BRAND_NAME = 'Newsec Team';
const BRAND_TITLE = 'Nordic Real Estate Experts';

function ThumbnailGallery({ onSelect, selected }) {
    return React.createElement('div', { className: 'grid grid-cols-3 gap-2 mb-2' },
        images.map(url =>
            React.createElement('img', {
                key: url, src: url, alt: 'thumb',
                onClick: () => onSelect(url),
                className:
                  "cursor-pointer object-cover w-full h-20 rounded transition ring-2 " +
                  (selected === url ? "ring-blue-700" : "ring-transparent hover:ring-blue-400")
            })
        )
    );
}

function LinkedInPostPreview({ profileImage, name, jobTitle, imageUrl, content }) {
    return React.createElement('div', { className: 'bg-white rounded-2xl border border-gray-200 p-4 shadow-sm max-w-xl mx-auto text-sm' },
        React.createElement('div', { className: 'flex space-x-3 items-center' },
            React.createElement('img', {
                src: profileImage, alt: name,
                className: 'w-12 h-12 rounded-full object-cover'
            }),
            React.createElement('div', null,
                React.createElement('h3', { className: 'font-semibold text-gray-800' }, name),
                React.createElement('p', { className: 'text-gray-500 text-xs' }, jobTitle),
                React.createElement('span', { className: 'text-gray-400 text-xs' }, 'Just now')
            )
        ),
        imageUrl && React.createElement('img', {
            src: imageUrl, alt: "Selected", className: 'w-full h-48 object-cover rounded mt-4 mb-2'
        }),
        React.createElement('p', { className: 'mt-2 whitespace-pre-line text-gray-800' }, content),
        React.createElement('div', { className: 'mt-4 flex justify-around text-gray-600 border-t pt-2' },
            ['Like', 'Comment', 'Share'].map(label =>
                React.createElement('button', {
                    key: label,
                    className: 'flex items-center space-x-1 hover:text-blue-700 font-medium'
                }, React.createElement('span', null, label))
            )
        )
    );
}

function App() {
    const [selectedImageUrl, setSelectedImageUrl] = useState('');
    const [postText, setPostText] = useState('');
    // Listen for post/image changes from outside
    useEffect(() => {
        window._postPreviewUpdate = (data = {}) => {
            if (data.postText !== undefined) setPostText(data.postText);
            if (data.imageUrl !== undefined) setSelectedImageUrl(data.imageUrl);
        };
        // initial value from DOM if present
        const el = document.getElementById('generatedPost');
        if (el) setPostText(el.innerText);
        return () => { window._postPreviewUpdate = () => {}; };
    }, []);
    return React.createElement('div', null,
        React.createElement(ThumbnailGallery, { onSelect: setSelectedImageUrl, selected: selectedImageUrl }),
        React.createElement(LinkedInPostPreview, {
            profileImage: BRAND_PROFILE_IMG,
            name: BRAND_NAME,
            jobTitle: BRAND_TITLE,
            imageUrl: selectedImageUrl,
            content: postText
        })
    );
}

ReactDOM.createRoot(document.getElementById('postPreviewRoot')).render(React.createElement(App));
</script>

<script>
/* After React loads, make sure whenever user generates a post, the preview updates.
   In your generatePost() and generateVisuals() just call:
     window._postPreviewUpdate({ postText: newPostText });
   And when selecting a stock image, call:
     window._postPreviewUpdate({ imageUrl: newImageUrl });
*/
</script>

</body>
</html>
